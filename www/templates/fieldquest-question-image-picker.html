<link rel="import" href="../fieldquest-question-base.html">
<link rel="import" href="../components/core-image/core-image.html">
<link rel="import" href="../components/core-icons/image-icons.html">

<polymer-element name="fieldquest-question-image-picker" extends="fieldquest-question-base">
<template>

  <style>
    :host {
      padding: 40px 10px;
    }
    
    :host-context(.wide) {
      padding: 40px 0px 48px;
    }

    :host paper-item {
      padding: 3px 28px;
    }
    
    :host-context(.wide) paper-item {
      padding: 3px 36px;
    }
    
    .sized {
        height: 200px;
        width: 49%;
    }
      
    .camera-icon {
        position: absolute;
        right: 16px;
        margin-top: 16px;
    }
      
  </style>

  <div>
      <div id="photoGrid">
          <core-image src="../images/wclt-1.jpg" sizing="cover" class="sized"></core-image>
      </div>
      <div><paper-fab icon="image:camera-alt" class="camera-icon" scale-up on-tap="{{capturePhoto}}"></paper-fab></div>
  </div>

    <div id="hiddenDiv" style="display: none;">
          <core-image id="hiddenImg" src="" sizing="cover" class="sized"></core-image>
    </div>

</template>
<script>
    
    Polymer('fieldquest-question-image-picker', {
        
        component: null,
        
        ready: function() {
            component = this;
        },
        
        isAnswered: function() {
            return true;
        },
        
        getValue: function() {
            return "Image 001.jpg, Image 002.jpg";
        },
        
        capturePhoto: function() {
            if (navigator.camera) {
                navigator.camera.getPicture(this.onCapturePhotoSuccess, this.onCapturePhotoFail, {
                    quality: 50,
                    saveToPhotoAlbum: true,
                    sourceType: Camera.PictureSourceType.CAMERA,
                    destinationType: Camera.DestinationType.FILE_URI
                });
            } else {
                alert("Camera not supported.");
            }
        },
        
        onCapturePhotoSuccess: function(imageURI) {
            console.log(imageURI);
            
            // clone hidden img element
            var hiddenImg = this.component.$.hiddenImg; 
            var newImg = hiddenImg.cloneNode(true);
            newImg.src = imageURI;

            // add new img elem to div container
            var photoGrid = this.component.$.photoGrid;
            photoGrid.appendChild(newImg);
        },
    
        onCapturePhotoFail: function (message) {
            alert("Failed because: " + message);
        }
        
    });
    
</script>
</polymer-element>